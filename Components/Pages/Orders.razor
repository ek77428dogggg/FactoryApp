@page "/orders"
@using FactoryApp.Models
@using FactoryApp.Data
@inject OrderService Service
<PageTitle>–ó–∞–∫–∞–∑—ã</PageTitle>
<h1>üìã –ó–∞–∫–∞–∑—ã</h1>
<p>–ó–¥–µ—Å—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤—Å–µ –∑–∞–∫–∞–∑—ã –∏–∑ –Ω–∞—à–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.</p>

@if (errorMessage != null)
{
    <div class="alert alert-danger">
        <strong>–û—à–∏–±–∫–∞:</strong> @errorMessage
    </div>
}
else if (orders == null)
{
    <p><em>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</em></p>
}
else if (!orders.Any())
{
    <p><em>–ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. –¢–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è.</em></p>
}
else
{
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>ID</th>
                <th>–ó–∞–∫–∞–∑—á–∏–∫</th>
                <th>–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞</th>
                <th>–°—É–º–º–∞ (—Ä—É–±)</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in orders)
            {
                <tr>
                    <td>@item.Id</td>
                    <td><strong>@item.CustomerName</strong></td>
                    <td>@item.OrderDate</td>
                    <td style="@(item.TotalAmount > 20000 ? "color: green; font-weight: bold;" : "")">
                        @item.TotalAmount.ToString("N2")
                    </td>
                </tr>
            }
        </tbody>
    </table>
}

@code {
    private List<Order> orders;
    private string errorMessage;

    protected override void OnInitialized()
    {
        try
        {
            orders = Service.GetOrders();
        }
        catch (Exception ex)
        {
            errorMessage = ex.Message;
            // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
            Console.WriteLine($"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∑–∞–∫–∞–∑–æ–≤: {ex.Message}");
        }
    }
}